"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},64704:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>x,staticGenerationAsyncStorage:()=>c});var s={};t.r(s),t.d(s,{POST:()=>d});var a=t(70101),o=t(90796),n=t(83055),i=t(12903),u=t(57125),l=t(68364);async function d(e){try{let{name:r,email:t,password:s,phone:a,country:o,city:n}=await e.json();if(!r||!t||!s)return i.NextResponse.json({error:"Campos requeridos faltantes",details:{name:r?null:"El nombre es requerido",email:t?null:"El email es requerido",password:s?null:"La contrase\xf1a es requerida"}},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return i.NextResponse.json({error:"Formato de email inv\xe1lido"},{status:400});if(s.length<6)return i.NextResponse.json({error:"La contrase\xf1a debe tener al menos 6 caracteres"},{status:400});if(r.trim().length<2)return i.NextResponse.json({error:"El nombre debe tener al menos 2 caracteres"},{status:400});if(await l._.user.findUnique({where:{email:t.toLowerCase()}}))return i.NextResponse.json({error:"Ya existe una cuenta con este email"},{status:409});let d=await u.ZP.hash(s,12),p=await l._.user.create({data:{name:r.trim(),email:t.toLowerCase(),password:d,role:"user"}});return i.NextResponse.json({message:"Cuenta creada exitosamente",userId:p.id,user:{id:p.id,name:p.name,email:p.email,role:p.role}},{status:201})}catch(e){if(console.error("Registration error:",e),"P2002"===e.code)return i.NextResponse.json({error:"Ya existe una cuenta con este email"},{status:409});if("P2003"===e.code)return i.NextResponse.json({error:"Error de referencia en la base de datos"},{status:400});return i.NextResponse.json({error:"Error interno del servidor. Por favor, intenta nuevamente."},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\BIENV\\Downloads\\auth-system\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:x}=p,h="/api/auth/register/route";function g(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:c})}},68364:(e,r,t)=>{t.d(r,{_:()=>a});let s=require("@prisma/client"),a=globalThis.prisma??new s.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9780,332,7125],()=>t(64704));module.exports=s})();